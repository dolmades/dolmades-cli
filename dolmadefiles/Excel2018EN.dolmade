# Name of the dolmade (very restricted by udocker)
DOLMADE 
 Excel2013EN

# Docker image to use as a base
BASE 
 dolmades/dolmades-docker:winestable

# Ingredients: sha256 / file name / display name / URL #1 / URL #2 / ...
INGREDIENT 
 dbd8a244999754401349bc81ef091e6b75918cb5ab6a638c21a2b8a4934fe93a
 Office_Pro_Plus_2013-x86-en.iso
 MS Office 13 EN Main Install CD
 file:///home/stefan/OldHome/MSOffice-2013/Office_Pro_Plus_2013-x86-en.iso

INGREDIENT 
 e1ac8b0b5ba0d74a9852cdcd494c6b69d463404bb98472831de20227a5e5298a
 Office_Multi_Lang_Pack_2013-x86-en.iso
 MS Office 13 EN Main Multi-Lang CD
 file:///home/stefan/OldHome/MSOffice-2013/Office_Multi_Lang_Pack_2013-x86-en.iso

# We need 7z to extract the ISO file
RUNROOT
 apt-get update && apt-get -y install p7zip-full && apt-get clean && rm -rf /var/lib/apt/lists/*

# Run a command inside the dolmade
# PWD is the install folder
RUNUSER 
 7z x Office_Pro_Plus_2013-x86-en.iso &&
 wine setup.exe &&
 winetricks corefonts &&
 cp /wineprefix/drive_c/ProgramData/Microsoft/OFFICE/DocumentRepository.ico /install/msoffice13.ico

ICON 
 msoffice13.ico

SETTARGET 
 echo "$(find /wineprefix/ -name EXCEL.EXE)"
